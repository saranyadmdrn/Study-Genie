var express=require("express"),path=require("path"),logger=require("morgan"),cookieParser=require("cookie-parser"),bodyParser=require("body-parser"),passport=require("passport");require("./config/db"),require("./config/passport");var app=express(),apiRoutes=require("./routes/routes");app.use(logger("dev")),app.use(bodyParser.json()),app.use(bodyParser.urlencoded({extended:!1})),app.use(cookieParser()),app.use(express.static(path.join(__dirname,"www"))),app.use(passport.initialize()),app.use("/api",apiRoutes),app.use(function(e,r){r.sendFile(path.join(__dirname,"www","index.html"))}),app.use(function(e,r,s){var a=new Error("Not Found");a.status=404,s(a)}),app.use(function(e,r,s,a){"UnauthorizedError"===e.name&&(s.status(401),s.json({message:e.name+": "+e.message}))}),app.use(function(e,r,s,a){s.status(e.status||500),s.render("error",{message:e.message,error:e})}),module.exports=app;