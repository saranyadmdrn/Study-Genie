<div class="container notes-container" ng-cloak>
    <div class="masonry-item note" ng-class="note.colorClass" ng-repeat="note in filteredNotes = ((notes | ngRepeatFinish:this) | filter:{isPinned:false} | filter:{isTrashed:false} | searchFor:searchString | filterTags:selectedTags)">
        <div class="note-main" data-toggle="modal" data-target="#note-view-modal-{{$index}}">
            <h3 class="note-title">{{ note.title }}</h3>
            <p class="note-content" froala-view="note.content | noteTilePrettify"></p>
        </div>
        <div class="note-tags">
            <ul>
                <li ng-repeat="tag in note.tags" ui-sref="notes.state-tags" ng-click="setSelectedTags([tag])">
                    {{tag}}
                </li>
            </ul>
        </div>
        <div class="note-opt">
            <a title="Edit" class="opt-tooltip opt-icon icon-pencil" data-toggle="modal" data-target="#note-edit-modal-{{$index}}" ng-click="setCurrentNote(note)"></a>
            <a title="Change color" class="opt-tooltip opt-icon icon-palette colors-popup">
                <ul>
                    <li class="color-btn" ng-class="colorClass" ng-repeat="colorClass in colorClasses" ng-click="setNoteColor(note, colorClass)"></li>
                </ul>
            </a>
            <a title="Archive" class="opt-tooltip opt-icon icon-archive" ng-click="archiveNote(note)"></a>
            <a class="opt-icon icon-dots menu-popup">
                <ul>
                    <li ng-click="copyNote(note)">Make a copy</li>
                    <li ng-click="moveNoteToTrash(note)">Delete note</li>
                </ul>
            </a>
        </div>
    </div>
    <div class="container-message" ng-show="filteredNotes.length === 0">
        <span class="glyphicon glyphicon-tag container-message-icon"></span>
        <p class="container-message-text">No notes found here</p>
    </div>
</div>
<div class="modal fade-pop note-modal note-edit-modal" ng-repeat="note in notes | filter:{isPinned:false} | filter:{isTrashed:false} | searchFor:searchString | filterTags:selectedTags" id="note-edit-modal-{{$index}}" role="dialog" edit-modals-loaded-directive>
    <div class="modal-dialog">
        <div class="modal-content" ng-class="note.colorClass">
            <form class="edit-note-form">
                <button type="button" class="close" data-dismiss="modal">&times;</button>
                <div class="modal-header">
                    <div class="form-group">
                        <label class="sr-only" for="title">Title: </label>
                        <textarea class="form-control input-title" rows="1" placeholder="Title" ng-model="note.title" maxlength="{{titleMaxLength}}"></textarea>
                    </div>
                </div>
                <div class="modal-body">
                    <div class="form-group">
                        <label class="sr-only" for="content">Content: </label>
                        <textarea froala="froalaOptions" ng-model="note.content"></textarea>
                    </div>
                </div>
                <div class="modal-footer">
                    <div class="note-modal-tags">
                        <ul>
                            <li ng-repeat="tag in note.tags">{{tag}}</li>
                        </ul>
                    </div>
                    <div class="note-modal-date">
                        <span title="Created {{note.dateCreated}}" class="opt-tooltip date">{{ note.dateCreated }}</span>
                    </div>
                    <div class="note-modal-opt">
                        <a title="Change color" class="opt-tooltip opt-icon-lg icon-palette colors-popup">
                            <ul>
                                <li ng-class="colorClass" class="color-btn" ng-repeat="colorClass in colorClasses" ng-click="setNoteColor(note, colorClass)"></li>
                            </ul>
                        </a>
                        <a title="Change tags" class="opt-tooltip opt-icon-lg icon-tag tags-popup">
                            <ul>
                                <li ng-repeat="tag in tags">
                                    <label ng-click="$event.stopPropagation();">
                                        <input type="checkbox" ng-checked="checkNoteTag(note, tag)" ng-click="changeNoteTagViaTagsPage(note, tag, $parent.$index)" /> {{tag}}</label>
                                </li>
                            </ul>
                        </a>
                        <a title="Archive" class="opt-tooltip opt-icon-lg icon-archive" ng-click="archiveNoteViaModal(note, $index)" data-dismiss="modal"></a>
                        <a title="Delete" class="opt-tooltip opt-icon-lg icon-trash" ng-click="moveNoteToTrashViaModal(note, $index)" data-dismiss="modal"></a>
                        <a title="All done" class="opt-tooltip opt-icon-lg icon-check" data-dismiss="modal"></a>
                    </div>
                </div>
            </form>
        </div>
    </div>
</div>
<div class="modal fade-pop note-modal note-view-modal" ng-repeat="note in notes | filter:{isPinned:false} | filter:{isTrashed:false} | searchFor:searchString | filterTags:selectedTags" id="note-view-modal-{{$index}}" role="dialog" view-modals-loaded-directive>
    <div class="modal-dialog">
        <div class="modal-content" ng-class="note.colorClass">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal">&times;</button>
                <h3 class="note-title">{{ note.title }}</h3>
            </div>
            <div class="modal-body">
                <p class="note-content" froala-view="note.content | noteModalPrettify" ng-dblclick="openEditModalViaViewModal(note, $index)"></p>
            </div>
            <div class="modal-footer">
                <div class="note-modal-tags">
                    <ul>
                        <li ng-repeat="tag in note.tags">{{tag}}</li>
                    </ul>
                </div>
                <div class="note-modal-date">
                    <span title="Created {{note.dateCreated}}" class="opt-tooltip date">{{ note.dateCreated }}</span>
                </div>
                <div class="note-modal-opt">
                    <a title="Edit" class="opt-tooltip opt-icon-lg icon-pencil" data-toggle="modal" ng-click="openEditModalViaViewModal(note, $index)"></a>
                    <a title="Change color" class="opt-tooltip opt-icon-lg icon-palette colors-popup">
                        <ul>
                            <li ng-class="colorClass" class="color-btn" ng-repeat="colorClass in colorClasses" ng-click="setNoteColor(note, colorClass)"></li>
                        </ul>
                    </a>
                    <a title="Archive" class="opt-tooltip opt-icon-lg icon-archive" ng-click="archiveNoteViaModal(note, $index)" data-dismiss="modal"></a>
                    <a title="Delete" class="opt-tooltip opt-icon-lg icon-trash" ng-click="moveNoteToTrashViaModal(note, $index)" data-dismiss="modal"></a>
                    <a title="All done" class="opt-tooltip opt-icon-lg icon-check" data-dismiss="modal"></a>
                </div>
            </div>
        </div>
    </div>
</div>
